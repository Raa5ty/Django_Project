{% extends 'base.html' %}

{% block title %}
    Поиск ТГ-каналов
{% endblock %}

{% block content %}
<!-- Страница подбора каналов -->
<div class="page" id="search-page">
    <h1 class="page-title">
        <a href="{% url 'tgservice:search' %}" style="color: inherit; text-decoration: none;">Новый рекламный проект</a>
    </h1>
    <!-- Форма для проекта -->
    <div class="form-container">
        <form method="post">
            {% csrf_token %}
            <div class="form-columns">
                <!-- строка 1 -->
                <div class="form-group">
                    <label class="form-label" for="id_name">Название проекта</label>
                    {{ form.name }}
                </div>
                <div class="form-group">
                    <label class="form-label" for="id_count_requested">Количество каналов</label>
                    {{ form.count_requested }}
                </div>
                <!-- строка 2 -->
                <div class="form-group">
                    <label class="form-label" for="id_description">Описание проекта</label>
                    {{ form.description }}
                </div>
                <div class="form-group">
                    <label class="form-label" for="id_target_audience">Целевая аудитория</label>
                    {{ form.target_audience }}
                </div>
                <!-- строка 3 -->
                <div class="form-group">
                    <label class="form-label" for="id_keywords">Ключевые слова</label>
                    {{ form.keywords }}
                </div>
                <div class="form-group">
                    <label class="form-label" for="id_creatives">Примеры креативов</label> 
                    {{ form.creatives }}
                </div>               
            </div>

                <div class="form-group">
                    <button type="submit" class="btn">Начать подбор</button>
                </div>
        </form>
    </div>

    <!-- Таблица результатов -->
    {% if project %}
    <div class="projects-description">
        <h2>Проект: {{ project.name }}</h2>
        <p><strong>Описание:</strong> {{ project.description }}</p>
        <p><strong>ЦА:</strong> {{ project.target_audience }}</p>
        <p><strong>Ключевые слова:</strong> {{ project.keywords }}</p>
    </div>

    <div class="projects-description">
        <h3>Найденные каналы</h3>
        <table class="form-control">
            <thead>
                <tr>
                    <th>Канал</th>
                    <th>Категория</th>
                    <th>Подписчики</th>
                    <th>Описание</th>
                    <th>Ключевые слова</th>
                    <th>Оценка</th>
                </tr>
            </thead>
            <tbody>
                {% for channel in channels %}
                <tr>
                    <td>{{ channel.channel_name }}</td>
                    <td>{{ channel.category }}</td>
                    <td>{{ channel.subscribers }}</td>
                    <td>{{ channel.description|truncatewords:20 }}</td>
                    <td>{{ channel.keywords_channel }}</td>
                    <td>{{ channel.score }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}

</div>
{% endblock %}           
